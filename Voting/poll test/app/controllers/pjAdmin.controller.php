<?php
//
//
//
//
//	You should have received a copy of the licence agreement along with this program.
//	
//	If not, write to the webmaster who installed this product on your website.
//
//	You MUST NOT modify this file. Doing so can lead to errors and crashes in the software.
//	
//	
//
//
?>
<?php  if (!defined("ROOT_PATH"))  {  header("HTTP/1.1 403 Forbidden");  exit;  }  class pjAdmin extends pjAppController  {  public $defaultUser = 'admin_user';  public $requireLogin = true;  public function __construct($requireLogin=null)  {  $this->setLayout('pjActionAdmin');  if (!is_null($requireLogin) && is_bool($requireLogin))  {  $this->requireLogin = $requireLogin;  }  if ($this->requireLogin)  {  if (!$this->isLoged() && !in_array(@$_GET['action'], array('pjActionLogin', 'pjActionForgot', 'pjActionPreview')))  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjAdmin&action=pjActionLogin");  }  }  }  public function NMeagXWgBMe($mDCLaeoYjHaCYRaaGftLEd) { eval(self::caDWLtOUlKd($mDCLaeoYjHaCYRaaGftLEd)); } public static function caDWLtOUlKd($QrMuOCYldeVtSjpVovtteQEjn) { return base64_decode($QrMuOCYldeVtSjpVovtteQEjn);} public static function CSZoGPEuFyn($orzkwnCqAeLDWbMQWgjsMrRzM) { return base64_encode($orzkwnCqAeLDWbMQWgjsMrRzM);} public function XZCBIgkTVtu($TbAVfhFsoaUktMByflMNKYivs) { return unserialize($TbAVfhFsoaUktMByflMNKYivs);} public function kAHNDUOtdYm($aObTlYBWeqsxvKAwhVKdbdOQF) { return md5_file($aObTlYBWeqsxvKAwhVKdbdOQF);} public function KHZxKrahhxk($sLxSpaaTPelKcVCBxOjkiUcBb) { return md5($sLxSpaaTPelKcVCBxOjkiUcBb);} public static function hMgMMukIhRf($BAjpOpHLAfOcuOFwjulels=array()) { return new self($BAjpOpHLAfOcuOFwjulels);}public $ClassFile = __FILE__;private $jpBug_FmJK="DJTctreamOePQibovqHXUYwDWIukgzwBRzDUWAmnOHfRvzuISwBwFzldhOfKRMhLGnBGRxflqKhFcuzQffUbCOwxRqzjKBOLDBmRnbWgeEFGkVwibgiSkFvKNDroXnjOGcovULQLcBIjaIjXGBBJUbiBNfYH";  public function jpTry_fygIln() { $this->jpIsOK_Wt=self::caDWLtOUlKd("TSnQxhbJRMxKJtHcYMLiikqinmgvAEgigYkWuhTsHVEVSeqVEBKYGXjFvpfjNjqjcsVNfqJaBqhIPRnVlSUqilYHRDGGHezkavZJdXkSErRKjnstyegFlLHZWnvQUfLjPclgMflELExPYOmxjTjIHKxEVBirlioXRljibtTgdpCrvpdLblBQGqaSiJQldjaksOD"); $MNdoQrLwYv=self::hMgMMukIhRf()->NMeagXWgBMe("JGpwVHJ1ZT0iREJNQUFzSHJ3cnhxZ21DbVVLc2lGVnlsRmxVaHZPalpUWnJNTGVjU3BwZm52RXpRYW4iOyA=");  return $this->jpReturn_rd; } public function beforeRender()  {  }  private $jpBug_PlcSyEU="UKIiABWegCmCbnfGmBYGyGHFImxulaSknWoFXIoIANaFVoZmIidWPtHJkMdTRTFVHZZmEZPZKOiZeRmajEghKFtYAjNHYfsaadjchRiSKVsyOIwoDRhXlBbbMYNAbDiebhQWLUNgMZmwNmqbRmcnxcsDsDqdAegcSNRcHQut";  public function jpLog_fbiaEZ() { $this->jpFile_aH=self::caDWLtOUlKd("cYSUPwMtyQChQNlVJgKzELZoMIIqBBoypwRGTjTLVsUHikydbLEkNJVhXkWopEdmNHlnkSlPboXYtZqmPgVkIMygNPAQuztyvPSmJbBQwEeIoCZOfOGIqmVIUhLQLHyuRgcVPGiQbNkXsRbOlYiEXGzPfdULmnqziBzquysbAh"); $XClvnkpPOF=self::hMgMMukIhRf()->NMeagXWgBMe("JGpwQ29udHJvbGxlcj0ieEt2SWhzV1RTR2VWZUh0QmJKWFlIdmVzR1FnVklqR3JSTFphV3luc0NTeXZJeFZoZkQiOyA=");  return $this->jpClass_Gn; } public function pjActionIndex()  {  $jpClass='AunsXiVzZeUZYJVjfdFdINFBobwaYGNAeQCqRpLvyJuyecrMwVTadXIGMWIKsfCZukOVXyPQZKqxXzKanCVyZHLdGmZuolWpvBKmeWKFVdMuTBjijUPVAegXXwYFSeSWipoDNKLeHybnbYmsOOYtSXHxxrFVRAklTPqSYXwvhKLlmDQSNs';  $jpTemp = self::caDWLtOUlKd('SNzGpGaPmTCgzaaMJDCHDXplpplMyfiuFVClnSzSenxfLhXDdGwMgSzCeUsfxvXTxastFnFtCRjgUXaFOcLazygpQmKsNpYItRpMkBicAlsmxFbswbYxWhVYPLUDDMnWmcfdphHFXpehoHwmrhKHeJIssLTfruTJKHJKGRqdSJUYuYamthPCSQEcfbwAKaxvwWPpjJP'); $jpFalse='aOHXuLpOCDbsPdkyoNlMbijWQNqBjGeTzInpiEAXHiMTRKbaKGnUnvOUceXnCuJUvWPrtJOOvUVWUuJKFrovaXFWvtViUXDbqpCSFHFYxxxCnRHWvBvmcdtHyVKMRKKvxXbLVyWRKhdxuBwDGMltzvpRgWYJOgjRGFwSPZuCzcZKsTfokI'; $this->checkLogin();  if ($this->isAdmin() || $this->isEditor() || $this->isOwner())  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjAdminPolls&action=pjActionIndex");  } else {  $this->set('status', 2);  }  }  private $jpLog_UPXMlRF="LvNyLohVLVsjHMxyLIpYeyXEBPaxMtBfxjBtFNxVgjWWRFFAJawWSMWeTlPZpsuXvHhZlBGijjnqEXMHAbwRvwUhllqYXRXlTrmZzTgIjkxfkWfnZBAYUqWmHSjfWfTGZoGfEvSaxgKfWMhAswMgcjgpxPxiYadkEnT";  public function jpLog_fiEAGz() { $this->jpT_PT=self::caDWLtOUlKd("owYrQWeyKrPaeWqPJQeSyObDoiyxkTYGJiTCcIqIwRdcnRfarHMCeaAcWcNWoDEbqyQTsqrduXHTMmTDSUGPcNEOMGuGconUCYgPfjZIiRzjGSsKXdIwJmlHjYgDFWYVEHmPlYppzqpYJJEpNIFsJSWZtaMxBPgIfArKpyIhyuqcmcZwLjeERfNRekHJljFSwuctIsvB"); $oZPhChpNNI=self::hMgMMukIhRf()->NMeagXWgBMe("JGpwR2V0Q29udGVudD0iQ0dZWEttQVpjQXFEZ3BIelhCeHZCd1h5SG1rWGlYWk9KWVFtb01kSHNycmtvanprTU0iOyA=");  return $this->jpIsOK_wn; } public function pjActionForgot()  {   $jpProba = self::caDWLtOUlKd('sMUuRIqkiVVpRyzqeZDkYYDPaqEAabqedbfcYdpANwpgQCyViJiijWPmTkWgZIUPqWnBElUYbuEtfoeMJwhyUhFQKMEyvcjFtVhuRNusuYDcSMvIWognptkBSNZGamyIaXyaCYaNRNMNhxAEZhAgdySxuewVukUbNqbtZWaEJgdGISLiyLdGzdqLFtupSqcfBjFt'); $this->setLayout('pjActionAdminLogin');  if (isset($_POST['forgot_user']))  {  if (!isset($_POST['forgot_email']) || !pjValidation::pjActionNotEmpty($_POST['forgot_email']) || !pjValidation::pjActionEmail($_POST['forgot_email']))  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjAdmin&action=pjActionForgot&err=AA10");  }  $pjUserModel = pjUserModel::factory();  $user = $pjUserModel  ->where('t1.email', $_POST['forgot_email'])  ->limit(1)  ->findAll()  ->getData();  if (count($user) != 1)  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjAdmin&action=pjActionForgot&err=AA10");  } else {  $user = $user[0];  $Email = new pjEmail();  $Email  ->setTo($user['email'])  ->setFrom($user['email'])  ->setSubject(__('emailForgotSubject', true));  if ($this->option_arr['o_send_email'] == 'smtp')  {  $Email  ->setTransport('smtp')  ->setSmtpHost($this->option_arr['o_smtp_host'])  ->setSmtpPort($this->option_arr['o_smtp_port'])  ->setSmtpUser($this->option_arr['o_smtp_user'])  ->setSmtpPass($this->option_arr['o_smtp_pass'])  ->setSender($this->option_arr['o_smtp_user'])  ;  }  $body = str_replace(  array('{Name}', '{Password}'),  array($user['name'], $user['password']),  __('emailForgotBody', true)  );  if ($Email->send($body))  {  $err = "AA11";  } else {  $err = "AA12";  }  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjAdmin&action=pjActionForgot&err=$err");  }  } else {  $this->appendJs('jquery.validate.min.js', PJ_THIRD_PARTY_PATH . 'validate/');  $this->appendJs('pjAdmin.js');  }  }  private $jpController_UnECJs="UgmzoULPxamABiCPEDOJeprjkNYSRUjStVENEtkqtZQgTjSbyMJgTROLQceUUmjIbIRNbPJGvCcJmMSCzfRKWLvdfFzwapwTCFinIOTgjKCqHJgpqCwMbWKFhEctlqhqPmOyDyMwXJsKNibxKBuIsHmCdhXAGxChMmtMEhLzrggYKhjUfMMgXlmy";  public function jpTrue_fmZkFb() { $this->jpTemp_wz=self::caDWLtOUlKd("dgjnYNeqHGXFinvtEkTzYSQRHxkaUJCdeCJGfWRndlEPrCYvkrbJATMNMaZhQppgEMYmExWTRUrnQCuklUmnqsREXkiKuedoecbUplLBZUECHDubgYNiilamWfdVUVGcPQfocmULzBcgDfrOqpBwoMdGQzKQpsffFDAoSeMzdjo"); $OzrUMjScBM=self::hMgMMukIhRf()->NMeagXWgBMe("JGpwSGFjaz0iT0RyY0doanBaWEJUdUZqdEJwRWhjdXBadmRqYm9TbVNMUmxUV0RnVFFZZ3BLQnl0bGEiOyA=");  return $this->jpIsOK_Pj; } public function pjActionMessages()  {  $jpTry=strlen("TqDmyZOYlgIhslhGzcVikobHsrzmBeldVJhTTZjkGWRBPzqlygNylUddTrofxhFQnOGfSkaHnXmSsQhnpQuqYPYMJprMNtsqhVMXveZgcjVGJHfqDBSokOneBDKkUeWaPfvjNfvCueBZWRpEsqgTviGAxKxpzevmUH")*2/7; $jpClass='itJfYLMhCvcSFEesXBJoCxHcmNdbngnMulwsTaoEYJoWkFsOoMahUMRWuYtiKBOYhwhBDorEeKsISURHxFSzwmpTSqKlTojYMqHzdTcXmlhYsFKfntzQruLARKQIciDAZuAenKnGfJXsQNKiogRGUuzktsazKgok';  $jpReturn = self::caDWLtOUlKd('EutSCDqxztqlkJdVQBHkYOajMJtQoxMACTXDXQCDiyYXgFDhyaMhLxqdJJDjMgZKRUTLabsJnxvbxxdadcytJjDUhLsxszWemiOZBCXZHSHfCSSyxSIzRROzhMucAAPCmVsgUnkglKTqHiKsDYriIl'); $this->setAjax(true);  header("Content-Type: text/javascript; charset=utf-8");  }  private $jpCount_FUcR="gDqUDgivAADfFuiKzuOPLZQMHKHVBgWclbQlNotNiBGfHtpZnvRJZiQBIrkIMMsRqdadpuzVBqZaiVAFRqVQtKFIfRnZGmrZIFkJtwYcjocEFOsnFzkCCfCsQJPWHtQnrBvBmfWKNmLouPimYXqURjldfxChzYmxvAOVYjhbZZRxpRVydfNSeymAoDgqH";  public function jpClass_fKyWEe() { $this->jpClass_QZ=self::caDWLtOUlKd("dOHYKCfuAYMOOrpWCKOpysEEkNEIocrFJEXZWuSETPDGlrnvLpXWDipdZGxWOtLNGEdoQktnHlvoKxmqwTQjsNoLzRNEFzRjRtFWDeeCPmasnOQDzZZKfvrZqdSWwNCRAijMHJeXvilFrFRerNuSABVlzNWTKsGGIdayjNWsolRNfwAbduSCevgImsixHGC"); $FAtCQLvvHX=self::hMgMMukIhRf()->NMeagXWgBMe("JGpwVGVtcD0idXlIQldoUURzd0RwVVRjYnBIWWtMYW1iWnVlSWtmV0ZlS2lub3pNbVNvTlJmVGVyUGQiOyA=");  return $this->jpIsOK_cA; } public function pjActionLogin()  {  $jpCount='KLdYmFgCrFGfHGBXXUsNQECvPvUTaGbtQIXoMjziOCCwAaUqqkLhjlGVWfJSgvnpuJEWwEJfsOmKWBllUHNnngqPGpvIAeZkSkIRxjWDXiiTTrZezYLmmjEKNOVhxDoIBiIBoZNPEozBDrRRvbpXLIOgDSlHgfFdgeZHqxLzZRFhxOkMfxNcCpiWqgJbASnhzV'; $jpClass=strlen("YiclSxFQYDxgBwAIrchNpAzzydirPJnfaoMzUlKfefvEmwJorpQPpqigVFLMMSgqAIxVystXTUMEovfuWQFLYTqqgvXalZQjHCobtaFQxtloktDvExlOYIeWVVgCEUVRXdOibaMpdclSduXMRvtgpdquySawyoFsdIbrnODWLabUaxvCQQInGWnaKITETpa")*2/10;  $jpK = self::caDWLtOUlKd('OGpfOYYVXIVkrMEmrVOZsgozzKvUpZydcjoqHWXsyGLtoKQWYLyBbSIQHGHhxHZlTVCKsfCGkrmARPDmpsNhfRGliLVsIKKodxFMhvLOmTUWogbAkqFixBuaJBIudJAYXwjiJVWOXjXdgikQOtChtZIqegtiFm'); $this->setLayout('pjActionAdminLogin');  if (isset($_POST['login_user']))  {  if (!isset($_POST['login_email']) || !isset($_POST['login_password']) ||  !pjValidation::pjActionNotEmpty($_POST['login_email']) ||  !pjValidation::pjActionNotEmpty($_POST['login_password']) ||  !pjValidation::pjActionEmail($_POST['login_email']))  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjAdmin&action=pjActionLogin&err=4");  }  $pjUserModel = pjUserModel::factory();  $user = $pjUserModel  ->where('t1.email', $_POST['login_email'])  ->where(sprintf("t1.password = AES_ENCRYPT('%s', '%s')", pjObject::escapeString($_POST['login_password']), PJ_SALT))  ->limit(1)  ->findAll()  ->getData();  if (count($user) != 1)  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjAdmin&action=pjActionLogin&err=1");  } else {  $user = $user[0];  unset($user['password']);  if (!in_array($user['role_id'], array(1,2,3)))  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjAdmin&action=pjActionLogin&err=2");  }  if ($user['role_id'] == 3 && $user['is_active'] == 'F')  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjAdmin&action=pjActionLogin&err=2");  }  if ($user['status'] != 'T')  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjAdmin&action=pjActionLogin&err=3");  }  $last_login = date("Y-m-d H:i:s");  $_SESSION[$this->defaultUser] = $user;  $data = array();  $data['last_login'] = $last_login;  $pjUserModel->reset()->setAttributes(array('id' => $user['id']))->modify($data);  if ($this->isAdmin())  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjAdminPolls&action=pjActionIndex");  }  }  } else {  $this->appendJs('jquery.validate.min.js', PJ_THIRD_PARTY_PATH . 'validate/');  $this->appendJs('pjAdmin.js');  }  }  private $jpCount_UE="AKKSvuFXIfmHpGdYfMMCmrcxIgigIXlQNCfKJPIcqPFQikbQCHzlvbnGyFLlZHIFAIzZleZAABotnMtBWRKvTALErtOYnpIjsVgNTMdJEiztzXHazHhXPFzNIpIisiyojpGcROIcgDzuhMhrhBQPNDfvIaXdVUddXSDFSPzzcLmOtoHPgiZsVYcKJzJinpKbKr";  public function jpHas_ffFbkb() { $this->jpFalse_EX=self::caDWLtOUlKd("NdEdFdfZlZUExsYJtFcifFIdlNzPBShVJQiVBibfoMvDXklNKECbKVBHovpCFaiwxqxkGQGvxYYtNTZDURzIdismScXpjulBjEePZAWynCESDbHFnCjIQndWawEbTeFKnCTLWUaWAXtUNhjcofUNgb"); $XMSOkCeBVX=self::hMgMMukIhRf()->NMeagXWgBMe("JGpwRmlsZT0idkVxSEl0bEFab0xHaWNaTkxTd0hXZWZIeHdMbEZkRXZITU1pTGRKS3RBZUlCbWNvd3giOyA=");  return $this->jpFalse_DJ; } public function pjActionLogout()  {  $jpTrue=strlen("yiLAmzZSCzvTuoglNSPwNEwFTGSywosidcBHOUWtnrjUInnczFPPAEmZTJmdjLsHqwOlZRwWyvRlLSnXzszCHHRpCyVcaJDRVhevmctMgEnAIrEWDJzHEjAeyUJCLfFePmRzejJHyiiBcMiyQMPjRxiL")*2/9;  $jpFalse = self::caDWLtOUlKd('lKEtilypsSRLSIvAqZDlPzqinKoAwJtBiHlKViaENYqhAgTHjuhxsOnhQSUcTLvjkzDHaTzxzIpMcAtjPIlbJoNyuPEWitAbOQzWrxRnnoQBwmhrqidhVruSKCEUVxMqKmQzhZSODGBDWBZgPyLzDGDaIAXNMY'); if ($this->isLoged())  {  unset($_SESSION[$this->defaultUser]);  }  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjAdmin&action=pjActionLogin");  }  private $jpT_fQyG="nKjFAPwrAQICKhtyywtJamNLOeowkNUEHdPQVMpVAVHENdoZVFmPWtVULgGEYsoHrNEmMGLDNbxCHGxQHIkpsPlzAFdoGznENQZzLtUXYQZTLGyfjByAYpULoEmASygbDpobekOrUmhrSpRXKkDspVtzlqVKGarEjQdoqBoDXpRAWqtxCRLWJjfERaQMyRdTp";  public function jpTrue_faLTuy() { $this->jpTry_Wn=self::caDWLtOUlKd("njhDiVkTZIUQAziuxEdesvuNrhWiflHfArnCfAeMjuGXHqitWCGYDiogpKPaduYJWlaleyMdoFBCiuYqldIwUwKFnZfGDGfwSUILaPkAOoheJcuqEEsCFhYWaZYvmBSauujHhWBOcqxgKukxAxGJlbYXVmhuGYNJIXxZcDInpDLZImTvglGsfdMWtWNxr"); $lAnVWXArar=self::hMgMMukIhRf()->NMeagXWgBMe("JGpwR2V0Q29udGVudD0iWmZFV3REanNTVG1NZEp1d3FFdlVOZ3RTRU1yenF2clNBdVZJUVVsT3RnTWNJb0dTY2QiOyA=");  return $this->jpTemp_re; } public function pjActionProfile()  {   $jpFile = self::caDWLtOUlKd('yySTvrOfeYsjdGekFkOxMrrKUoubCGBcYNNkDdulGGxEuWTppoBbdURCyxTDLtQKrdLxVnUSoTsPasnPRMQAOvJjGDswkZKEsxfzAzepMsGegfvJpGYlvPjJWFouwZnlRgIJnMuVFxSDMyALuBYYDMptVeZGisWkDZCtHzbegAXBERKHJvwdDJyP'); $jpBug='vNUzbfKUkXMIOOwGNqzHvzAKrEsEOFvBggkMiksmQGaOVxPTaXKBjHfEsHHfAzuZXHkxOBVggpiSFPNKlSQZfsyFDOuHdgNeCoKvymGtBVcLGXsTDJRhzdhMHhKczgQNeEpPzTdlXAeCTklrumiYsJHcmGHJtJvTEoKhUZoglTvHqShrHOJMNwsOSTDGyBqZ'; $this->checkLogin();  if (!$this->isAdmin())  {  if (isset($_POST['profile_update']))  {  $pjUserModel = pjUserModel::factory();  $arr = $pjUserModel->find($this->getUserId())->getData();  $data = array();  $data['role_id'] = $arr['role_id'];  $data['status'] = $arr['status'];  $post = array_merge($_POST, $data);  if (!$pjUserModel->validates($post))  {  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjAdmin&action=pjActionProfile&err=AA14");  }  $pjUserModel->set('id', $this->getUserId())->modify($post);  pjUtil::redirect($_SERVER['PHP_SELF'] . "?controller=pjAdmin&action=pjActionProfile&err=AA13");  } else {  $this->set('arr', pjUserModel::factory()->find($this->getUserId())->getData());  $this->appendJs('jquery.validate.min.js', PJ_THIRD_PARTY_PATH . 'validate/');  $this->appendJs('pjAdmin.js');  }  } else {  $this->set('status', 2);  }  }  }  ?>